# 1. (a)
set.seed(99)
X = rnorm(100, mean=5, sd=3)

# 1. (b)
fx <- function(x, a, b){
  y = (x-a)/b
  return(y)
}

# test
fx(10, 2, 4) == 2

# 1. (c)
# Sample 
y = fx(X, 5, 3)
y_mean = mean(y) # sample meean
y_sd = sd(y)     # sample standard deviation

# Population
population_mean <- mean(y)
population_var <- var(y)*(100-1)/100 # n = 100
population_sd <- sqrt(population_var)
population_sd

# qq Plot can tell whether a piece of data fits the normal distribution. 
# Firstly, we drew qq plot of the original data, and then drew the graph of Y. 
# It can be found that the two are exactly the same and almost all the points are on a straight line, 
# which means that there is sufficient evidence that y also conforms to a normal distribution.
qqnorm(X,col="red",pch=19)
qqline(X,col="black")
qqnorm(X,col="red",pch=19)
qqline(X,col="black")

# 1.(d) 
#histogram(y)
#plot(density(y))
# library(ggplot2)
# g=ggplot(mtcars,aes(x =mpg))+
#   geom_histogram(aes(y=..density..), 
#                  color="#88ada6", fill="#fffbf0",
#                  main = "Histogram & Estimated Probability Density Function",
#                  alpha=.8,  # ???????????????????????????
#                  binwidth = 2, # ???????????????????????????????????????????????????????????????bins = 30
#                  center = 0)+ # ??????????????????????????????????????????0?????????????????????1????????????????????????????????????????????????????????????
#   geom_density() 

hist(y,main="Histogram & Estimated Probability Density Function",freq=FALSE)
lines(density(y))

# 1. (e)
hist(y,main = "Histogram & True Probability Density Function",freq=FALSE)
d <- seq(from=min(y), to=max(y), by=0.01)
lines(d, dnorm(d,0,1))

# 2. (a)
# install.packages("hflights")
library(hflights)
data <- hflights
r = nrow(hflights)
c = ncol(hflights)
col_name = colnames(hflights)    # return the column names

# 2. (b)
phflights <- hflights[1:15,]
sflights <- hflights[ ,colnames(hflights) %in% c('DepTime', 'ArrTime', 'FlightNum')]
head(sflights)

# 2. (c)
BNum = hflights$FlightNum > 1000
# BNBNum = BNum[ ,colnames(BNum) %in% c('FlightNum')]
head(BNum)
sflights$BNum<-BNum
head(sflights)

# 2.(d)
library("dplyr")
# ???????????????????????????
dest_arr <- group_by(hflights, Dest)
dest_AvgDelay <- summarise(dest_arr, ArrDelay=mean(ArrDelay, na.rm=TRUE))
head(dest_AvgDelay)

# ????????????????????????????????????
carr_fli <- group_by(hflights, UniqueCarrier)
cancel_devert <- summarise(carr_fli , Cancelled=mean(Cancelled), Diverted=mean(Diverted))
head(cancel_devert)
